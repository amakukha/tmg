Port of Unix TMG to C99.

Work in progress.
